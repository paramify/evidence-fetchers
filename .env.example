# =============================================================================
# Paramify Evidence Fetchers Environment Variables Configuration
# =============================================================================

# =============================================================================
# Instructions:
# 1. Copy this content to a file named ".env" in the project root
# 2. Replace "your_token_here" with your actual Paramify API token
# 3. Uncomment and modify optional settings as needed 
# =============================================================================

# =============================================================================
# Paramify API Configuration
    # REQUIRED: Your Paramify Evidence API Token
    PARAMIFY_UPLOAD_API_TOKEN=your_token_here

    # Optional: Paramify API Base URL (defaults to https://api.paramify.com)
    # PARAMIFY_API_BASE_URL=https://api.paramify.com

    # Optional: Paramify MCP API Bearer Token (if using MCP features)
    # PARAMIFY_MCP_API_TOKEN=   
# =============================================================================

# =============================================================================
# Fetcher timeout in seconds
    # FETCHER_TIMEOUT=300  # 5 minutes
# =============================================================================

# =============================================================================
# Okta Configuration
    # OKTA_API_TOKEN=your_okta_api_token_here   # Replace with your actual Okta API token
    # OKTA_ORG_URL=https://your-org.okta.com
# =============================================================================

# =============================================================================
# SentinelOne Configuration
    # SENTINELONE_API_TOKEN=your_sentinelone_api_token_here   # Replace with your actual SentinelOne API token
    # SENTINELONE_API_URL=https://your-org.sentinelone.net # This will closely resemble the following format: https://usgovwe1-#.s1gov.net
# =============================================================================

# =============================================================================
# KnowBe4 API Configuration
    # KNOWBE4_API_KEY="fjkfjkfjkfjkfjkfjkfjkfjkfjkfjkfjkfjkfjkfjkfjkfjkfjk"  # Replace with your actual KnowBe4 API key
    # KNOWBE4_REGION="US"  # One of: US, EU, CA, UK, DE
# =============================================================================

# =============================================================================
# Rippling API Configuration
    # RIPPLING_API_TOKEN=your_rippling_api_token_here   # Replace with your actual Rippling API token
# =============================================================================


# =============================================================================
# AWS Configuration
# =============================================================================
    # Global AWS settings (used for single-instance mode and as defaults)
    # AWS_PROFILE=gov_readonly # Replace with your actual AWS profile
    # AWS_DEFAULT_REGION=us-gov-west-1 # Replace with your actual AWS region
    # IAM_ROLES_FETCHER=--exclude-aws-managed-roles       # Exclude AWS managed roles from iam_roles fetcher

    # =============================================================================
    # AWS Multi-Region Configuration
    # =============================================================================
    # Define multiple AWS regions as needed

    # Region 1: Government Cloud (US Gov West 1)
    # AWS_REGION_1=us-gov-west-1    # Replace with your actual AWS region
    # AWS_REGION_1_PROFILE=gov_readonly     # Replace with your actual AWS profile
    # AWS_REGION_1_FETCHERS=iam_roles,guard_duty    # Replace with desired fetchers for this region

    # Region 2: US East 1
    # AWS_REGION_2=us-east-1
    # AWS_REGION_2_PROFILE=production
    # AWS_REGION_2_FETCHERS=s3_encryption_status,iam_policies
# =============================================================================


# =============================================================================
# GitLab Configuration
# =============================================================================
    # Global GitLab settings (used for single-instance mode and as defaults)
    # GITLAB_URL=https://gitlab.example.com
    # GITLAB_API_TOKEN=glpat-xxxxxxxxxxxxxxxxxxxx
    # GITLAB_PROJECT_ID=group/project

    # Optional global defaults
    # GITLAB_BRANCH=main
    # GITLAB_FILE_PATTERNS=.tf,.tfvars,.yml,.yaml,.json,Dockerfile,.sh
    # GITLAB_MR_STATE=merged        # merged|opened|closed|all
    # GITLAB_MR_DAYS_BACK=30
    # GITLAB_MR_MAX_RESULTS=50

    # =============================================================================
    # GitLab Multi-Project Configuration
    # =============================================================================
    # Define multiple GitLab projects as needed (fetchers expect project access tokens for scoped API access)
    # GITLAB_PROJECT_1_URL=https://gitlab.example.com
    # GITLAB_PROJECT_1_ID=group/change-management
    # GITLAB_PROJECT_1_API_ACCESS_TOKEN=glpat-xxxxxxxxxxxxxxxxxxxx
    # GITLAB_PROJECT_1_FETCHERS=gitlab_ci_cd_pipeline_config,gitlab_project_summary,gitlab_merge_request_summary

    # GITLAB_PROJECT_2_URL=https://gitlab.example.com
    # GITLAB_PROJECT_2_ID=group/terraform
    # GITLAB_PROJECT_2_API_ACCESS_TOKEN=glpat-yyyyyyyyyyyyyyyyyyyy
    # GITLAB_PROJECT_2_FETCHERS=gitlab_ci_cd_pipeline_config,gitlab_project_summary

    # GITLAB_PROJECT_3_URL=https://gitlab.example.com
    # GITLAB_PROJECT_3_ID=group/main-application
    # GITLAB_PROJECT_3_API_ACCESS_TOKEN=glpat-zzzzzzzzzzzzzzzzzzzz
    # GITLAB_PROJECT_3_FETCHERS=gitlab_merge_request_summary

    # Optional project-specific override examples (use if different from globals)
    # GITLAB_PROJECT_1_BRANCH_CICD=dev-branch
    # GITLAB_PROJECT_2_FILE_PATTERNS=.py,.ini
    # GITLAB_PROJECT_3_MR_STATE=closed
    # GITLAB_PROJECT_4_MR_MAX_RESULTS=20
# =============================================================================


# =============================================================================
# Checkov Configuration
# =============================================================================
    # Global Checkov settings (used for single-instance mode and as defaults)
    # CHECKOV_REPO_ID=evidence-fetchers-terraform
    # CHECKOV_BRANCH=main
    # CHECKOV_SOFT_FAIL=true
    # CHECKOV_COMPACT=true
    # CHECKOV_DOWNLOAD_EXTERNAL_MODULES=true
    # CHECKOV_EVALUATE_VARIABLES=true
    # CHECKOV_CLONE_REPO=false  # Set to true to clone entire repo (slower, more storage) vs API downloads (faster, less storage)

    # Optional global defaults
    # Recommended: Use framework-specific check variables (auto-filters by framework)
    # Option 1: Leave CHECKOV_K8S_CHECKS unset to run all checks (skip list will filter out problematic ones)
    # CHECKOV_K8S_CHECKS=
    # CHECKOV_TERRAFORM_CHECKS=
    
    # Option 2: Specify only important checks that are likely to pass
    # CHECKOV_K8S_CHECKS=CKV2_K8S_6,CKV_K8S_14,CKV_K8S_16,CKV_K8S_17,CKV_K8S_18,CKV_K8S_19,CKV_K8S_21,CKV_K8S_24,CKV_K8S_25,CKV_K8S_26,CKV_K8S_27,CKV_K8S_32,CKV_K8S_33,CKV_K8S_34,CKV_K8S_36,CKV_K8S_39,CKV_K8S_41,CKV_K8S_42,CKV_K8S_44,CKV_K8S_45
    # CHECKOV_TERRAFORM_CHECKS=CKV_AWS_21,CKV_AWS_23,CKV_AWS_24,CKV_AWS_20,CKV_AWS_2,CKV_AWS_19,CKV_AWS_3,CKV_AWS_41,CKV_AWS_18,CKV_AWS_67,CKV_AWS_49,CKV_AWS_1,CKV_AWS_126,CKV_AWS_65
    
    # Alternative: Use single CHECKOV_CHECKS variable (will auto-filter by framework)
    # CHECKOV_CHECKS=CKV_K8S_20,CKV_K8S_22,CKV_AWS_21,CKV_AWS_23  # Auto-filters: K8S checks for kubernetes scans, AWS checks for terraform scans
    
    # Note: CHECKOV_SEVERITY is not supported by Checkov CLI (ignored to prevent failures)
    # To filter by severity, use CHECKOV_CHECKS with specific check IDs or use Prisma Cloud API
    # CHECKOV_SKIP_PATHS=modules,examples,test

    # =============================================================================
    # Checkov Multi-Instance Configuration
    # =============================================================================
    # Define multiple Checkov scan instances for standalone sources (not tied to GitLab projects)
    # Note: For GitLab projects, add checkov_terraform/checkov_kubernetes to GITLAB_PROJECT_X_FETCHERS instead

    # Instance 1: Terraform scanning from local directory
    # CHECKOV_INSTANCE_1_SOURCE_TYPE=local  # Options: local, github, url
    # CHECKOV_INSTANCE_1_SOURCE_PATH=/path/to/terraform/code  # Absolute path to local directory
    # CHECKOV_INSTANCE_1_FETCHERS=checkov_terraform
    # CHECKOV_INSTANCE_1_REPO_ID=evidence-fetchers-terraform
    # CHECKOV_INSTANCE_1_BRANCH=main
    # CHECKOV_INSTANCE_1_SOFT_FAIL=true
    # CHECKOV_INSTANCE_1_COMPACT=true
    # CHECKOV_INSTANCE_1_DOWNLOAD_EXTERNAL_MODULES=true
    # CHECKOV_INSTANCE_1_EVALUATE_VARIABLES=true
    # CHECKOV_INSTANCE_1_CHECKS=CKV_AWS_21,CKV_AWS_24
    # CHECKOV_INSTANCE_1_SKIP_CHECKS=CKV_AWS_23  # Merged with defaults from skip-checks.default.txt
    # CHECKOV_INSTANCE_1_SEVERITY=HIGH,MEDIUM  # Used with --skip-check
    # CHECKOV_INSTANCE_1_SKIP_RESOURCES=aws_s3_bucket.gitlab_runner_cache  # Merged with defaults from skip-resources.default.txt
    # CHECKOV_INSTANCE_1_SKIP_PATHS=modules,examples,test
    # CHECKOV_INSTANCE_1_DEEP_ANALYSIS=true  # Requires --repo-root-for-plan-enrichment
    # CHECKOV_INSTANCE_1_REPO_ROOT=/path/to/repo  # Repository root for plan enrichment
    # CHECKOV_INSTANCE_1_TERRAFORM_PLAN_FILE=/path/to/tfplan.json  # Terraform plan JSON file

    # Instance 2: Kubernetes scanning from local directory
    # CHECKOV_INSTANCE_2_SOURCE_TYPE=local  # Options: local, github, url
    # CHECKOV_INSTANCE_2_SOURCE_PATH=/path/to/kubernetes/manifests  # Absolute path to local directory
    # CHECKOV_INSTANCE_2_FETCHERS=checkov_kubernetes
    # CHECKOV_INSTANCE_2_SKIP_CHECKS=CKV_K8S_14,CKV_K8S_11
    # CHECKOV_INSTANCE_2_SEVERITY=HIGH

    # Instance 3: Terraform scanning from GitHub repository
    # CHECKOV_INSTANCE_3_SOURCE_TYPE=github
    # CHECKOV_INSTANCE_3_SOURCE_URL=https://github.com/owner/repo
    # CHECKOV_INSTANCE_3_SOURCE_BRANCH=main
    # CHECKOV_INSTANCE_3_FETCHERS=checkov_terraform
    # CHECKOV_INSTANCE_3_SKIP_CHECKS=CKV_AWS_20,CKV_AWS_57
    # CHECKOV_INSTANCE_3_SKIP_PATHS=modules,test

    # Optional instance-specific override examples (use if different from globals)
    # CHECKOV_INSTANCE_1_REPO_ID=custom-repo-id
    # CHECKOV_INSTANCE_2_BRANCH=dev-branch
    # CHECKOV_INSTANCE_3_SOFT_FAIL=false
# =============================================================================